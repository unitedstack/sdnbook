# IP 组播相关

---

组播（又称：多播）是指把信息同时传递给一组目的地址。与多播相比，常规的点到单点传递被称作单播。IP 多播是一种通过使用一个多播地址将数据在同一时间以高效的方式发往处于 TCP/IP
网络上的多个接收者的协议。


## VRRP

[VRRP](https://en.wikipedia.org/wiki/Virtual_Router_Redundancy_Protocol) 协议使用到了 IP 组播，是由 IETF 提出的解决局域网中配置静态网关出现单点失效现象的路由协议。

VRRP 不仅提高可靠性，还简化了主机的配置。在具有多播或广播能力的局域网中，借助 VRRP 能在某台路由器出现故障时仍然提供高可靠的缺省链路，有效避免单一链路发生故障后网络中断的问题，而无需修改动态路由协议、路由发现协议等配置信息。

一个 VRRP 路由器有唯一的标识：VRID，范围为 0—255。 该路由器对外表现为唯一的虚拟MAC地址，地址的格式为00-00-5E-00-01-[VRID]｡ 主控路由器负责对 ARP 请求用该 MAC 地址做应答｡ 这样，无论如何切换，保证给终端设备的是唯一一致的 IP 和 MAC 地址
，减少了切换对终端设备的影响｡

VRRP 的工作过程如下：

 1. 路由器开启 VRRP 功能后，会根据优先级确定自己在备份组中的角色。优先级高的路由器成为主用路由器，优先级低的成为备用路由器。主用路由器定期发送 VRRP 通告报文，通知备份组内的其他路由器自己工作正常；备用路由器则启动定时器等待通告报文的到来。

 2. VRRP在不同的主用抢占方式下，主用角色的替换方式不同：
   * 在抢占方式下，当主用路由器收到 VRRP 通告报文后，会将自己的优先级与通告报文中的优先级进行比较。如果大于通告报文中的优先级，则成为主用路由器；否则将保持备用状态。
   * 在非抢占方式下，只要主用路由器没有出现故障，备份组中的路由器始终保持主用或备用状态，备份组中的路由器即使随后被配置了更高的优先级也不会成为主用路由器
。
 3. 如果备用路由器的定时器超时后仍未收到主用路由器发送来的 VRRP 通告报文，则认为主用路由器已经无法正常工作，此时备用路由器会认为自己是主用路由器，并对外发送 VRRP 通告报文。备份组内的路由器根据优先级选举出主用路由器，承担报文的转发功能。
